<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>å‡ºå ´è€…èª¿æŸ» - æ±è¥¿é«˜æ ¡ç”Ÿé¸æŠœãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å¤§ä¼šåŒ—æµ·é“äºˆé¸</title>
    
    <!-- note.comæœ€é©åŒ–ãƒ¡ã‚¿ã‚¿ã‚° -->
    <meta property="og:title" content="ğŸ¸ å‡ºå ´è€…èª¿æŸ»" />
    <meta property="og:description" content="æ±è¥¿é«˜æ ¡ç”Ÿé¸æŠœãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å¤§ä¼šåŒ—æµ·é“äºˆé¸ã®å‚åŠ å¸Œæœ›èª¿æŸ»ãƒ•ã‚©ãƒ¼ãƒ ã€‚é«˜æ ¡1ãƒ»2å¹´ç”Ÿå¯¾è±¡ã€8ã‚«ãƒ†ã‚´ãƒªãƒ¼è©³ç´°é›†è¨ˆæ©Ÿèƒ½æ­è¼‰ã€‚" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="æ±è¥¿é«˜æ ¡ç”Ÿé¸æŠœãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å¤§ä¼š" />
    <meta name="description" content="æ±è¥¿é«˜æ ¡ç”Ÿé¸æŠœãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å¤§ä¼šåŒ—æµ·é“äºˆé¸ã®å‚åŠ å¸Œæœ›èª¿æŸ»ãƒ•ã‚©ãƒ¼ãƒ ã€‚å„å­¦æ ¡ã®å‚åŠ äºˆå®šäººæ•°ã‚’å…¥åŠ›ã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆã‚’ç¢ºèªã§ãã¾ã™ã€‚" />
    <meta name="keywords" content="ãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³,é«˜æ ¡ç”Ÿ,é¸æŠœå¤§ä¼š,åŒ—æµ·é“,å‡ºå ´è€…èª¿æŸ»,å‚åŠ ç”³è¾¼" />
    
    <!-- note.comè¡¨ç¤ºæœ€é©åŒ– -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="ğŸ¸ å‡ºå ´è€…èª¿æŸ»" />
    <meta name="twitter:description" content="æ±è¥¿é«˜æ ¡ç”Ÿé¸æŠœãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å¤§ä¼šåŒ—æµ·é“äºˆé¸ã®å‚åŠ å¸Œæœ›èª¿æŸ»" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic UI', 'Meiryo UI', 'ãƒ¡ã‚¤ãƒªã‚ª', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 5px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 5px;
        }

        .header {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            padding: 25px 20px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .main-title {
            color: #2c3e50;
            font-size: 2rem;
            margin-bottom: 12px;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .info-badge {
            display: inline-block;
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-top: 10px;
        }

        .tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 6px;
            margin-bottom: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
            backdrop-filter: blur(10px);
        }

        .tab {
            flex: 1;
            padding: 16px 12px;
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: bold;
            transition: all 0.3s ease;
            color: #666;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            min-height: 50px;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transform: translateY(-1px);
        }

        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin: 20px 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #2c3e50;
            font-size: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            touch-action: manipulation;
        }

        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            outline: none;
            transform: translateY(-1px);
        }

        select.form-control {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 14px center;
            background-repeat: no-repeat;
            background-size: 18px;
            padding-right: 50px;
        }

        .participants-section {
            margin-top: 30px;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 25px;
            padding-bottom: 12px;
            border-bottom: 3px solid #667eea;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 2px;
        }

        .participants-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 18px;
            margin-bottom: 25px;
        }

        .participant-card {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 18px;
            border-radius: 12px;
            border-left: 5px solid #667eea;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .participant-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .participant-card label {
            color: #495057;
            font-size: 0.95rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 18px 35px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 25px;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:hover, .btn:active {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, #5a6fd8, #6a42a8);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        /* çµ±è¨ˆè¡¨ç¤ºã®é«˜åº¦ãªã‚¹ã‚¿ã‚¤ãƒ« */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .stats-section {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 15px;
            border-left: 6px solid #667eea;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

        .stats-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }

        .stats-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 18px;
            padding-bottom: 10px;
            border-bottom: 2px solid #dee2e6;
            position: relative;
        }

        .stats-title::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 50px;
            height: 2px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 1px;
        }

        .stats-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
            transition: all 0.2s ease;
        }

        .stats-item:last-child {
            border-bottom: none;
        }

        .stats-item:hover {
            background: rgba(102, 126, 234, 0.05);
            margin: 0 -10px;
            padding: 12px 10px;
            border-radius: 8px;
        }

        .stats-label {
            font-size: 0.95rem;
            color: #495057;
            flex: 1;
            font-weight: 500;
        }

        .stats-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
            text-align: right;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .schools-list {
            background: white;
            border-radius: 12px;
            border: 1px solid #e0e6ed;
            margin-top: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .school-item {
            padding: 18px 25px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }

        .school-item:last-child {
            border-bottom: none;
        }

        .school-item:hover {
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
        }

        .school-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.05rem;
        }

        .school-details {
            display: flex;
            gap: 18px;
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        .admin-section {
            background: linear-gradient(145deg, #fff3cd, #ffeaa7);
            padding: 25px;
            border-radius: 12px;
            border-left: 5px solid #ffc107;
            margin-top: 25px;
            box-shadow: 0 5px 20px rgba(255, 193, 7, 0.2);
        }

        .admin-controls {
            display: none;
        }

        body.admin-mode .admin-controls {
            display: block;
        }

        .admin-btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .message {
            padding: 18px 25px;
            border-radius: 12px;
            margin: 20px 0;
            font-weight: 500;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .message.success {
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
            color: #155724;
            border-left: 5px solid #28a745;
        }

        .message.error {
            background: linear-gradient(145deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border-left: 5px solid #dc3545;
        }

        .message.info {
            background: linear-gradient(145deg, #d1ecf1, #bee5eb);
            color: #0c5460;
            border-left: 5px solid #17a2b8;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®å¼·åŒ– */
        @media (max-width: 768px) {
            .container {
                padding: 2px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .main-title {
                font-size: 1.6rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .tab {
                padding: 14px 8px;
                font-size: 0.85rem;
            }
            
            .tab-content {
                padding: 20px 15px;
            }
            
            .participants-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .admin-btn-group {
                grid-template-columns: 1fr;
            }

            .school-details {
                flex-direction: column;
                gap: 8px;
                text-align: right;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 2px;
            }
            
            .main-title {
                font-size: 1.4rem;
            }
            
            .btn {
                padding: 20px 25px;
                font-size: 1.1rem;
            }

            input[type="text"],
            input[type="email"],
            select {
                padding: 16px 18px;
                font-size: 16px;
            }

            .stats-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .stats-value {
                align-self: flex-end;
            }
        }

        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã®è¿½åŠ  */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content {
            animation: fadeInUp 0.4s ease-out;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .btn:active {
            animation: pulse 0.3s ease;
        }

        /* ãƒ—ãƒªãƒ³ãƒˆæœ€é©åŒ– */
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                max-width: none;
                margin: 0;
                padding: 0;
            }
            
            .tabs,
            .admin-section,
            .btn {
                display: none;
            }
            
            .tab-content {
                display: block !important;
                background: white;
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }

        /* ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã®å‘ä¸Š */
        .btn:focus,
        .tab:focus,
        .form-control:focus {
            outline: 3px solid #667eea;
            outline-offset: 2px;
        }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .loading {
            position: relative;
            opacity: 0.7;
            pointer-events: none;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 25px;
            height: 25px;
            margin: -12.5px 0 0 -12.5px;
            border: 3px solid #667eea;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="main-title">ğŸ¸ å‡ºå ´è€…èª¿æŸ»</h1>
            <p class="subtitle">æ±è¥¿é«˜æ ¡ç”Ÿé¸æŠœãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å¤§ä¼šåŒ—æµ·é“äºˆé¸</p>
            <div class="info-badge">é«˜æ ¡1ãƒ»2å¹´ç”Ÿå¯¾è±¡ | 8ã‚«ãƒ†ã‚´ãƒªãƒ¼è©³ç´°é›†è¨ˆ</div>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="application">ğŸ“ å‚åŠ ç”³è¾¼ã¿</button>
            <button class="tab" data-tab="dashboard">ğŸ“Š å‚åŠ çŠ¶æ³</button>
            <button class="tab" data-tab="admin">ğŸ” ç®¡ç†è€…</button>
        </div>

        <!-- å‚åŠ ç”³è¾¼ã¿ã‚¿ãƒ– -->
        <div id="application" class="tab-content active">
            <form id="applicationForm">
                <div class="form-group">
                    <label for="schoolName">å­¦æ ¡å *</label>
                    <input type="text" id="schoolName" name="schoolName" class="form-control" placeholder="â—‹â—‹é«˜ç­‰å­¦æ ¡" required>
                </div>
                
                <div class="form-group">
                    <label for="teacherName">æ‹…å½“è€…å *</label>
                    <input type="text" id="teacherName" name="teacherName" class="form-control" placeholder="å±±ç”° å¤ªéƒ" required>
                </div>
                
                <div class="form-group">
                    <label for="email">é€£çµ¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *</label>
                    <input type="email" id="email" name="email" class="form-control" placeholder="example@school.ed.jp" required>
                </div>

                <div class="participants-section">
                    <div class="section-title">ğŸ¸ å‚åŠ è€…æ•°å…¥åŠ›</div>
                    <div class="participants-grid">
                        <div class="participant-card">
                            <label for="first_male_singles">1å¹´ç”·å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</label>
                            <select id="first_male_singles" name="first_male_singles" class="form-control">
                                <option value="0">0å</option>
                                <option value="1">1å</option>
                                <option value="2">2å</option>
                                <option value="3">3å</option>
                                <option value="4">4å</option>
                                <option value="5">5å</option>
                                <option value="6">6å</option>
                                <option value="7">7å</option>
                                <option value="8">8å</option>
                                <option value="9">9å</option>
                                <option value="10">10å</option>
                                <option value="11">11å</option>
                                <option value="12">12å</option>
                                <option value="13">13å</option>
                                <option value="14">14å</option>
                                <option value="15">15å</option>
                                <option value="16">16å</option>
                                <option value="17">17å</option>
                                <option value="18">18å</option>
                                <option value="19">19å</option>
                                <option value="20">20å</option>
                            </select>
                        </div>
                        
                        <div class="participant-card">
                            <label for="first_female_doubles">1å¹´å¥³å­ãƒ€ãƒ–ãƒ«ã‚¹</label>
                            <select id="first_female_doubles" name="first_female_doubles" class="form-control">
                                <option value="0">0çµ„</option>
                                <option value="1">1çµ„</option>
                                <option value="2">2çµ„</option>
                                <option value="3">3çµ„</option>
                                <option value="4">4çµ„</option>
                                <option value="5">5çµ„</option>
                                <option value="6">6çµ„</option>
                                <option value="7">7çµ„</option>
                                <option value="8">8çµ„</option>
                                <option value="9">9çµ„</option>
                                <option value="10">10çµ„</option>
                                <option value="11">11çµ„</option>
                                <option value="12">12çµ„</option>
                                <option value="13">13çµ„</option>
                                <option value="14">14çµ„</option>
                                <option value="15">15çµ„</option>
                                <option value="16">16çµ„</option>
                                <option value="17">17çµ„</option>
                                <option value="18">18çµ„</option>
                                <option value="19">19çµ„</option>
                                <option value="20">20çµ„</option>
                            </select>
                        </div>
                        
                        <div class="participant-card">
                            <label for="first_female_singles">1å¹´å¥³å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</label>
                            <select id="first_female_singles" name="first_female_singles" class="form-control">
                                <option value="0">0å</option>
                                <option value="1">1å</option>
                                <option value="2">2å</option>
                                <option value="3">3å</option>
                                <option value="4">4å</option>
                                <option value="5">5å</option>
                                <option value="6">6å</option>
                                <option value="7">7å</option>
                                <option value="8">8å</option>
                                <option value="9">9å</option>
                                <option value="10">10å</option>
                                <option value="11">11å</option>
                                <option value="12">12å</option>
                                <option value="13">13å</option>
                                <option value="14">14å</option>
                                <option value="15">15å</option>
                                <option value="16">16å</option>
                                <option value="17">17å</option>
                                <option value="18">18å</option>
                                <option value="19">19å</option>
                                <option value="20">20å</option>
                            </select>
                        </div>
                        
                        <div class="participant-card">
                            <label for="first_male_doubles">1å¹´ç”·å­ãƒ€ãƒ–ãƒ«ã‚¹</label>
                            <select id="first_male_doubles" name="first_male_doubles" class="form-control">
                                <option value="0">0çµ„</option>
                                <option value="1">1çµ„</option>
                                <option value="2">2çµ„</option>
                                <option value="3">3çµ„</option>
                                <option value="4">4çµ„</option>
                                <option value="5">5çµ„</option>
                                <option value="6">6çµ„</option>
                                <option value="7">7çµ„</option>
                                <option value="8">8çµ„</option>
                                <option value="9">9çµ„</option>
                                <option value="10">10çµ„</option>
                                <option value="11">11çµ„</option>
                                <option value="12">12çµ„</option>
                                <option value="13">13çµ„</option>
                                <option value="14">14çµ„</option>
                                <option value="15">15çµ„</option>
                                <option value="16">16çµ„</option>
                                <option value="17">17çµ„</option>
                                <option value="18">18çµ„</option>
                                <option value="19">19çµ„</option>
                                <option value="20">20çµ„</option>
                            </select>
                        </div>
                        
                        <div class="participant-card">
                            <label for="second_male_singles">2å¹´ç”·å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</label>
                            <select id="second_male_singles" name="second_male_singles" class="form-control">
                                <option value="0">0å</option>
                                <option value="1">1å</option>
                                <option value="2">2å</option>
                                <option value="3">3å</option>
                                <option value="4">4å</option>
                                <option value="5">5å</option>
                                <option value="6">6å</option>
                                <option value="7">7å</option>
                                <option value="8">8å</option>
                                <option value="9">9å</option>
                                <option value="10">10å</option>
                                <option value="11">11å</option>
                                <option value="12">12å</option>
                                <option value="13">13å</option>
                                <option value="14">14å</option>
                                <option value="15">15å</option>
                                <option value="16">16å</option>
                                <option value="17">17å</option>
                                <option value="18">18å</option>
                                <option value="19">19å</option>
                                <option value="20">20å</option>
                            </select>
                        </div>
                        
                        <div class="participant-card">
                            <label for="second_female_doubles">2å¹´å¥³å­ãƒ€ãƒ–ãƒ«ã‚¹</label>
                            <select id="second_female_doubles" name="second_female_doubles" class="form-control">
                                <option value="0">0çµ„</option>
                                <option value="1">1çµ„</option>
                                <option value="2">2çµ„</option>
                                <option value="3">3çµ„</option>
                                <option value="4">4çµ„</option>
                                <option value="5">5çµ„</option>
                                <option value="6">6çµ„</option>
                                <option value="7">7çµ„</option>
                                <option value="8">8çµ„</option>
                                <option value="9">9çµ„</option>
                                <option value="10">10çµ„</option>
                                <option value="11">11çµ„</option>
                                <option value="12">12çµ„</option>
                                <option value="13">13çµ„</option>
                                <option value="14">14çµ„</option>
                                <option value="15">15çµ„</option>
                                <option value="16">16çµ„</option>
                                <option value="17">17çµ„</option>
                                <option value="18">18çµ„</option>
                                <option value="19">19çµ„</option>
                                <option value="20">20çµ„</option>
                            </select>
                        </div>
                        
                        <div class="participant-card">
                            <label for="second_female_singles">2å¹´å¥³å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</label>
                            <select id="second_female_singles" name="second_female_singles" class="form-control">
                                <option value="0">0å</option>
                                <option value="1">1å</option>
                                <option value="2">2å</option>
                                <option value="3">3å</option>
                                <option value="4">4å</option>
                                <option value="5">5å</option>
                                <option value="6">6å</option>
                                <option value="7">7å</option>
                                <option value="8">8å</option>
                                <option value="9">9å</option>
                                <option value="10">10å</option>
                                <option value="11">11å</option>
                                <option value="12">12å</option>
                                <option value="13">13å</option>
                                <option value="14">14å</option>
                                <option value="15">15å</option>
                                <option value="16">16å</option>
                                <option value="17">17å</option>
                                <option value="18">18å</option>
                                <option value="19">19å</option>
                                <option value="20">20å</option>
                            </select>
                        </div>
                        
                        <div class="participant-card">
                            <label for="second_male_doubles">2å¹´ç”·å­ãƒ€ãƒ–ãƒ«ã‚¹</label>
                            <select id="second_male_doubles" name="second_male_doubles" class="form-control">
                                <option value="0">0çµ„</option>
                                <option value="1">1çµ„</option>
                                <option value="2">2çµ„</option>
                                <option value="3">3çµ„</option>
                                <option value="4">4çµ„</option>
                                <option value="5">5çµ„</option>
                                <option value="6">6çµ„</option>
                                <option value="7">7çµ„</option>
                                <option value="8">8çµ„</option>
                                <option value="9">9çµ„</option>
                                <option value="10">10çµ„</option>
                                <option value="11">11çµ„</option>
                                <option value="12">12çµ„</option>
                                <option value="13">13çµ„</option>
                                <option value="14">14çµ„</option>
                                <option value="15">15çµ„</option>
                                <option value="16">16çµ„</option>
                                <option value="17">17çµ„</option>
                                <option value="18">18çµ„</option>
                                <option value="19">19çµ„</option>
                                <option value="20">20çµ„</option>
                            </select>
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn">ğŸ“¤ èª¿æŸ»å›ç­”ã‚’é€ä¿¡</button>
            </form>
        </div>

        <!-- å‚åŠ çŠ¶æ³ã‚¿ãƒ– -->
        <div id="dashboard" class="tab-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px;">
                <h2 style="color: #2c3e50; margin: 0; font-size: 1.4rem;">ğŸ“Š å‚åŠ çŠ¶æ³åˆ†æ</h2>
                <div class="admin-controls">
                    <button onclick="exportCSV()" class="btn" style="width: auto; margin: 0; padding: 12px 24px; font-size: 1rem;">
                        ğŸ“ CSVå‡ºåŠ›
                    </button>
                </div>
            </div>

            <div id="statistics"></div>
            <div id="applicantsList"></div>
        </div>

        <!-- ç®¡ç†è€…ã‚¿ãƒ– -->
        <div id="admin" class="tab-content">
            <div class="admin-section">
                <div class="section-title">ğŸ” ç®¡ç†è€…æ©Ÿèƒ½</div>
                <div class="form-group">
                    <label for="adminPassword">ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
                    <input type="password" id="adminPassword" class="form-control" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
                </div>
                <button type="button" class="btn" onclick="adminLogin()">ğŸ”“ ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</button>
                
                <div class="admin-controls" id="adminControls">
                    <div class="admin-btn-group">
                        <button type="button" class="btn" onclick="exportCSV()">ğŸ“¥ CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
                        <button type="button" class="btn btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let applications = [];
        let isAdminMode = false;

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã‚­ãƒ¼
        const STORAGE_KEY = 'badminton_applications_survey_2024';

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å‡ºå ´è€…èª¿æŸ»ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–é–‹å§‹');
            loadData();
            updateDashboard();
            setupEventListeners();
            enhanceSmartphoneSupport();
            console.log('ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†');
        });

        // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        function loadData() {
            try {
                const data = localStorage.getItem(STORAGE_KEY);
                applications = data ? JSON.parse(data) : [];
                console.log(`${applications.length}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
            } catch (error) {
                console.error('ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                applications = [];
                showMessage('âš ï¸ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚', 'error');
            }
        }

        // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
        function saveData() {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(applications));
                console.log('ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            } catch (error) {
                console.error('ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
                showMessage('âš ï¸ ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚', 'error');
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function setupEventListeners() {
            // ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetTab = this.getAttribute('data-tab');
                    switchTab(targetTab);
                });
            });

            // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ
            document.getElementById('applicationForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleFormSubmit(e);
            });

            console.log('ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šå®Œäº†');
        }

        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function switchTab(tabName) {
            console.log('ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ:', tabName);
            
            // å…¨ã¦ã®ã‚¿ãƒ–ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // æŒ‡å®šã•ã‚ŒãŸã‚¿ãƒ–ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ–ã®å ´åˆã¯ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
            if (tabName === 'dashboard') {
                updateDashboard();
            }
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
        function handleFormSubmit(e) {
            console.log('ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡é–‹å§‹');
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã«è¨­å®š
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'é€ä¿¡ä¸­...';
            submitBtn.classList.add('loading');
            
            try {
                const formData = new FormData(e.target);
                const data = {};
                
                // å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ¤œè¨¼
                const requiredFields = ['schoolName', 'teacherName', 'email'];
                for (let field of requiredFields) {
                    const value = formData.get(field);
                    if (!value || value.trim() === '') {
                        throw new Error(`${getFieldLabel(field)}ã¯å¿…é ˆé …ç›®ã§ã™ã€‚`);
                    }
                    data[field] = value.trim();
                }
                
                // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼æ¤œè¨¼
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(data.email)) {
                    throw new Error('æ­£ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                }
                
                // æ•°å€¤ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å‡¦ç†
                const numberFields = [
                    'first_male_singles', 'first_male_doubles',
                    'first_female_singles', 'first_female_doubles',
                    'second_male_singles', 'second_male_doubles',
                    'second_female_singles', 'second_female_doubles'
                ];
                
                let totalParticipants = 0;
                for (let field of numberFields) {
                    let value = parseInt(formData.get(field)) || 0;
                    data[field] = value;
                    // ãƒ€ãƒ–ãƒ«ã‚¹ã¯1çµ„=2äººã§è¨ˆç®—
                    if (field.includes('doubles')) {
                        totalParticipants += value * 2;
                    } else {
                        totalParticipants += value;
                    }
                }
                
                // å‚åŠ è€…æ•°ã®æ¤œè¨¼
                if (totalParticipants === 0) {
                    throw new Error('å°‘ãªãã¨ã‚‚1åä»¥ä¸Šã®å‚åŠ äºˆå®šè€…ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                }
                
                // æ—¢å­˜ç”³è¾¼ã®ãƒã‚§ãƒƒã‚¯
                const existingIndex = applications.findIndex(app => 
                    app.schoolName.toLowerCase() === data.schoolName.toLowerCase()
                );
                
                if (existingIndex !== -1) {
                    if (!confirm('ã“ã®å­¦æ ¡ã‹ã‚‰ã®å›ç­”ãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã¾ã™ã‹ï¼Ÿ')) {
                        return;
                    }
                    applications[existingIndex] = { ...data, timestamp: new Date().toISOString() };
                    showMessage('âœ… ç”³è¾¼ã¿æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼', 'success');
                } else {
                    applications.push({ ...data, timestamp: new Date().toISOString() });
                    showMessage('âœ… å‚åŠ ç”³è¾¼ã¿ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸï¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ğŸ‰', 'success');
                }
                
                // ãƒ‡ãƒ¼ã‚¿ä¿å­˜
                saveData();
                updateDashboard();
                
                // ãƒ•ã‚©ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
                e.target.reset();
                
                // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚¿ãƒ–ã«åˆ‡ã‚Šæ›¿ãˆ
                setTimeout(() => {
                    switchTab('dashboard');
                }, 2500);
                
                console.log('ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å®Œäº†');
                
            } catch (error) {
                showMessage(`âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                console.error('ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
            } finally {
                // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’è§£é™¤
                setTimeout(() => {
                    submitBtn.textContent = originalText;
                    submitBtn.classList.remove('loading');
                }, 500);
            }
        }

        // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ©ãƒ™ãƒ«å–å¾—
        function getFieldLabel(field) {
            const labels = {
                schoolName: 'å­¦æ ¡å',
                teacherName: 'æ‹…å½“è€…å',
                email: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹'
            };
            return labels[field] || field;
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°ï¼ˆ8ã‚«ãƒ†ã‚´ãƒªãƒ¼è©³ç´°é›†è¨ˆæ©Ÿèƒ½ï¼‰
        function updateDashboard() {
            console.log('ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°é–‹å§‹');
            const statisticsDiv = document.getElementById('statistics');
            const applicantsDiv = document.getElementById('applicantsList');
            
            if (!statisticsDiv || !applicantsDiv) {
                console.error('ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                return;
            }
            
            if (applications.length === 0) {
                statisticsDiv.innerHTML = `
                    <div class="message info">
                        <strong>ğŸ“¢ èª¿æŸ»é–‹å§‹</strong><br>
                        ã¾ã å‚åŠ ç”³è¾¼ã¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚å„æ ¡ã‹ã‚‰ã®å›ç­”ã‚’ãŠå¾…ã¡ã—ã¦ã„ã¾ã™ã€‚
                    </div>
                `;
                applicantsDiv.innerHTML = '';
                return;
            }

            // çµ±è¨ˆè¨ˆç®—
            const stats = calculateStatistics();
            
            // 5ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆã®è©³ç´°çµ±è¨ˆè¡¨ç¤ºï¼ˆã“ã‚Œã¾ã§ã®ç©ã¿é‡ã­ï¼‰
            statisticsDiv.innerHTML = `
                <div class="stats-grid">
                    <div class="stats-section">
                        <div class="stats-title">1ï¸âƒ£ åŸºæœ¬çµ±è¨ˆ</div>
                        <div class="stats-item">
                            <span class="stats-label">å›ç­”å­¦æ ¡æ•°</span>
                            <span class="stats-value">${stats.totalSchools}æ ¡</span>
                        </div>
                        <div class="stats-item">
                            <span class="stats-label">ç·å‚åŠ äºˆå®šè€…æ•°</span>
                            <span class="stats-value">${stats.totalParticipants}å</span>
                        </div>
                    </div>

                    <div class="stats-section">
                        <div class="stats-title">2ï¸âƒ£ å­¦å¹´åˆ¥é›†è¨ˆ</div>
                        <div class="stats-item">
                            <span class="stats-label">1å¹´ç”Ÿå‚åŠ äºˆå®šè€…æ•°</span>
                            <span class="stats-value">${stats.firstYearTotal}å</span>
                        </div>
                        <div class="stats-item">
                            <span class="stats-label">2å¹´ç”Ÿå‚åŠ äºˆå®šè€…æ•°</span>
                            <span class="stats-value">${stats.secondYearTotal}å</span>
                        </div>
                    </div>

                    <div class="stats-section">
                        <div class="stats-title">3ï¸âƒ£ æ€§åˆ¥é›†è¨ˆ</div>
                        <div class="stats-item">
                            <span class="stats-label">ç”·å­å‚åŠ äºˆå®šè€…æ•°ï¼ˆ1ãƒ»2å¹´åˆè¨ˆï¼‰</span>
                            <span class="stats-value">${stats.maleTotal}å</span>
                        </div>
                        <div class="stats-item">
                            <span class="stats-label">å¥³å­å‚åŠ äºˆå®šè€…æ•°ï¼ˆ1ãƒ»2å¹´åˆè¨ˆï¼‰</span>
                            <span class="stats-value">${stats.femaleTotal}å</span>
                        </div>
                    </div>

                    <div class="stats-section">
                        <div class="stats-title">4ï¸âƒ£ ç«¶æŠ€ç¨®ç›®åˆ¥é›†è¨ˆ</div>
                        <div class="stats-item">
                            <span class="stats-label">ã‚·ãƒ³ã‚°ãƒ«ã‚¹ç·æ•°ï¼ˆç”·å¥³ãƒ»å­¦å¹´åˆè¨ˆï¼‰</span>
                            <span class="stats-value">${stats.singlesTotal}å</span>
                        </div>
                        <div class="stats-item">
                            <span class="stats-label">ãƒ€ãƒ–ãƒ«ã‚¹ç·æ•°ï¼ˆç”·å¥³ãƒ»å­¦å¹´åˆè¨ˆï¼‰</span>
                            <span class="stats-value">${stats.doublesTotal}çµ„</span>
                        </div>
                        <div class="stats-item">
                            <span class="stats-label">ãƒ€ãƒ–ãƒ«ã‚¹å‚åŠ è€…æ•°ï¼ˆçµ„Ã—2åï¼‰</span>
                            <span class="stats-value">${stats.doublesTotal * 2}å</span>
                        </div>
                    </div>

                    <div class="stats-section" style="grid-column: 1 / -1;">
                        <div class="stats-title">5ï¸âƒ£ è©³ç´°é›†è¨ˆï¼ˆå…¨8ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼‰</div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 18px;">
                            <div class="stats-item">
                                <span class="stats-label">ğŸ¥‡ 1å¹´ç”Ÿç”·å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.firstMaleSingles}å</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">ğŸ† 1å¹´ç”Ÿç”·å­ãƒ€ãƒ–ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.firstMaleDoubles}çµ„</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">ğŸ¥‡ 1å¹´ç”Ÿå¥³å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.firstFemaleSingles}å</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">ğŸ† 1å¹´ç”Ÿå¥³å­ãƒ€ãƒ–ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.firstFemaleDoubles}çµ„</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">ğŸ¥‡ 2å¹´ç”Ÿç”·å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.secondMaleSingles}å</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">ğŸ† 2å¹´ç”Ÿç”·å­ãƒ€ãƒ–ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.secondMaleDoubles}çµ„</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">ğŸ¥‡ 2å¹´ç”Ÿå¥³å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.secondFemaleSingles}å</span>
                            </div>
                            <div class="stats-item">
                                <span class="stats-label">ğŸ† 2å¹´ç”Ÿå¥³å­ãƒ€ãƒ–ãƒ«ã‚¹</span>
                                <span class="stats-value">${stats.secondFemaleDoubles}çµ„</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // å­¦æ ¡åˆ¥ä¸€è¦§ã®è¡¨ç¤ºï¼ˆå€‹äººæƒ…å ±ä¿è­·å¯¾å¿œï¼‰
            const sortedApplications = [...applications].sort((a, b) => a.schoolName.localeCompare(b.schoolName));
            
            applicantsDiv.innerHTML = `
                <div class="section-title">ğŸ“‹ å‚åŠ æ ¡ä¸€è¦§</div>
                <div class="schools-list">
                    ${sortedApplications.map(app => {
                        const schoolStats = calculateSchoolStats(app);
                        return `
                            <div class="school-item">
                                <div class="school-name">ğŸ« ${app.schoolName}</div>
                                <div class="school-details">
                                    <span>ğŸ¥‡ ã‚·ãƒ³ã‚°ãƒ«ã‚¹: ${schoolStats.singlesTotal}å</span>
                                    <span>ğŸ† ãƒ€ãƒ–ãƒ«ã‚¹: ${schoolStats.doublesTotal}çµ„</span>
                                    <span><strong>ğŸ‘¥ åˆè¨ˆ: ${schoolStats.totalPeople}å</strong></span>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
            
            console.log('ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°å®Œäº†');
        }

        // çµ±è¨ˆè¨ˆç®—ï¼ˆ8ã‚«ãƒ†ã‚´ãƒªãƒ¼å¯¾å¿œï¼‰
        function calculateStatistics() {
            const stats = {
                totalSchools: applications.length,
                totalParticipants: 0,
                firstYearTotal: 0,
                secondYearTotal: 0,
                maleTotal: 0,
                femaleTotal: 0,
                singlesTotal: 0,
                doublesTotal: 0,
                firstMaleSingles: 0,
                firstMaleDoubles: 0,
                firstFemaleSingles: 0,
                firstFemaleDoubles: 0,
                secondMaleSingles: 0,
                secondMaleDoubles: 0,
                secondFemaleSingles: 0,
                secondFemaleDoubles: 0
            };

            applications.forEach(app => {
                stats.firstMaleSingles += app.first_male_singles || 0;
                stats.firstMaleDoubles += app.first_male_doubles || 0;
                stats.firstFemaleSingles += app.first_female_singles || 0;
                stats.firstFemaleDoubles += app.first_female_doubles || 0;
                stats.secondMaleSingles += app.second_male_singles || 0;
                stats.secondMaleDoubles += app.second_male_doubles || 0;
                stats.secondFemaleSingles += app.second_female_singles || 0;
                stats.secondFemaleDoubles += app.second_female_doubles || 0;
            });

            // äººæ•°è¨ˆç®—ï¼ˆãƒ€ãƒ–ãƒ«ã‚¹ã¯1çµ„=2äººï¼‰
            stats.firstYearTotal = stats.firstMaleSingles + (stats.firstMaleDoubles * 2) + stats.firstFemaleSingles + (stats.firstFemaleDoubles * 2);
            stats.secondYearTotal = stats.secondMaleSingles + (stats.secondMaleDoubles * 2) + stats.secondFemaleSingles + (stats.secondFemaleDoubles * 2);
            stats.maleTotal = stats.firstMaleSingles + (stats.firstMaleDoubles * 2) + stats.secondMaleSingles + (stats.secondMaleDoubles * 2);
            stats.femaleTotal = stats.firstFemaleSingles + (stats.firstFemaleDoubles * 2) + stats.secondFemaleSingles + (stats.secondFemaleDoubles * 2);
            stats.singlesTotal = stats.firstMaleSingles + stats.firstFemaleSingles + stats.secondMaleSingles + stats.secondFemaleSingles;
            stats.doublesTotal = stats.firstMaleDoubles + stats.firstFemaleDoubles + stats.secondMaleDoubles + stats.secondFemaleDoubles;
            stats.totalParticipants = stats.firstYearTotal + stats.secondYearTotal;

            return stats;
        }

        // å­¦æ ¡åˆ¥çµ±è¨ˆè¨ˆç®—
        function calculateSchoolStats(app) {
            const singlesTotal = (app.first_male_singles || 0) + (app.first_female_singles || 0) + 
                               (app.second_male_singles || 0) + (app.second_female_singles || 0);
            const doublesTotal = (app.first_male_doubles || 0) + (app.first_female_doubles || 0) + 
                               (app.second_male_doubles || 0) + (app.second_female_doubles || 0);
            const totalPeople = singlesTotal + (doublesTotal * 2);
            
            return {
                singlesTotal,
                doublesTotal,
                totalPeople
            };
        }

        // ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            
            if (password === 'badminton2024') {
                isAdminMode = true;
                document.body.classList.add('admin-mode');
                document.getElementById('adminPassword').value = '';
                showMessage('âœ… ç®¡ç†è€…ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸã€‚é«˜åº¦ãªæ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚', 'success');
                updateDashboard();
            } else {
                showMessage('âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚', 'error');
                document.getElementById('adminPassword').value = '';
            }
        }

        // CSVå‡ºåŠ›ï¼ˆExcelå¯¾å¿œï¼‰
        function exportCSV() {
            console.log('CSVå‡ºåŠ›é–‹å§‹');
            
            if (!isAdminMode) {
                showMessage('âŒ ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚å…ˆã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚', 'error');
                return;
            }
            
            if (applications.length === 0) {
                showMessage('â„¹ï¸ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚', 'info');
                return;
            }

            const headers = [
                'å­¦æ ¡å', 'æ‹…å½“è€…å', 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
                '1å¹´ç”·å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹', '1å¹´ç”·å­ãƒ€ãƒ–ãƒ«ã‚¹', '1å¹´å¥³å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹', '1å¹´å¥³å­ãƒ€ãƒ–ãƒ«ã‚¹',
                '2å¹´ç”·å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹', '2å¹´ç”·å­ãƒ€ãƒ–ãƒ«ã‚¹', '2å¹´å¥³å­ã‚·ãƒ³ã‚°ãƒ«ã‚¹', '2å¹´å¥³å­ãƒ€ãƒ–ãƒ«ã‚¹',
                'åˆè¨ˆå‚åŠ è€…æ•°', 'ç”³è¾¼æ—¥æ™‚'
            ];

            const csvData = applications.map(app => {
                const schoolStats = calculateSchoolStats(app);
                return [
                    app.schoolName,
                    app.teacherName,
                    app.email,
                    app.first_male_singles || 0,
                    app.first_male_doubles || 0,
                    app.first_female_singles || 0,
                    app.first_female_doubles || 0,
                    app.second_male_singles || 0,
                    app.second_male_doubles || 0,
                    app.second_female_singles || 0,
                    app.second_female_doubles || 0,
                    schoolStats.totalPeople,
                    new Date(app.timestamp).toLocaleString('ja-JP')
                ];
            });

            const csvContent = [headers, ...csvData]
                .map(row => row.map(field => `"${field}"`).join(','))
                .join('\n');

            // UTF-8 BOMä»˜ãã§Excelå¯¾å¿œ
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `badminton_survey_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showMessage('âœ… CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸã€‚Excelã§é–‹ã‘ã¾ã™ğŸ“Š', 'success');
        }

        // å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
        function clearAllData() {
            if (applications.length === 0) {
                showMessage('â„¹ï¸ ã‚¯ãƒªã‚¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚', 'info');
                return;
            }

            if (confirm('âš ï¸ æœ¬å½“ã«ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                if (confirm('âš ï¸ æœ€çµ‚ç¢ºèª\nã™ã¹ã¦ã®ç”³è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ãŒå®Œå…¨ã«å‰Šé™¤ã•ã‚Œã¾ã™ã€‚\nç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿ')) {
                    applications = [];
                    localStorage.removeItem(STORAGE_KEY);
                    updateDashboard();
                    showMessage('âœ… ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚', 'success');
                }
            }
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºï¼ˆè¦–è¦šåŠ¹æœå¼·åŒ–ï¼‰
        function showMessage(message, type = 'info') {
            // æ—¢å­˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
            const existingMessage = document.querySelector('.message');
            if (existingMessage) {
                existingMessage.remove();
            }

            // æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆ
            const messageElement = document.createElement('div');
            messageElement.className = `message ${type}`;
            messageElement.innerHTML = message;

            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŒ¿å…¥
            const container = document.querySelector('.container');
            container.insertBefore(messageElement, container.children[1]);

            // 7ç§’å¾Œã«è‡ªå‹•å‰Šé™¤
            setTimeout(() => {
                if (messageElement.parentNode) {
                    messageElement.style.opacity = '0';
                    messageElement.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        messageElement.remove();
                    }, 300);
                }
            }, 7000);

            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¾ã§ã‚¹ãƒ ãƒ¼ã‚ºã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            messageElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œå¼·åŒ–
        function enhanceSmartphoneSupport() {
            // ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆã®æ”¹å–„
            document.querySelectorAll('.btn, .tab').forEach(element => {
                element.addEventListener('touchstart', function(e) {
                    this.style.opacity = '0.8';
                    this.style.transform = 'scale(0.98)';
                }, { passive: true });
                
                element.addEventListener('touchend', function(e) {
                    this.style.opacity = '1';
                    this.style.transform = 'scale(1)';
                }, { passive: true });
                
                element.addEventListener('touchcancel', function(e) {
                    this.style.opacity = '1';
                    this.style.transform = 'scale(1)';
                }, { passive: true });
            });

            // ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ”¹å–„
            document.querySelectorAll('input, select').forEach(element => {
                element.addEventListener('focus', function() {
                    setTimeout(() => {
                        this.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 300);
                });
            });

            // ãƒãƒ¼ãƒãƒ£ãƒ«ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å¯¾å¿œ
            if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                window.addEventListener('resize', function() {
                    if (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'SELECT') {
                        setTimeout(() => {
                            document.activeElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }, 100);
                    }
                });
            }

            console.log('ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å¯¾å¿œå¼·åŒ–å®Œäº†');
        }

        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', function(e) {
            console.error('JavaScriptã‚¨ãƒ©ãƒ¼:', e.error);
            showMessage('âš ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚', 'error');
        });

        window.addEventListener('unhandledrejection', function(e) {
            console.error('æœªå‡¦ç†Promiseæ‹’å¦:', e.reason);
            showMessage('âš ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚', 'error');
        });

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
        window.addEventListener('load', function() {
            console.log('ğŸ¸ æ±è¥¿é«˜æ ¡ç”Ÿé¸æŠœãƒãƒ‰ãƒŸãƒ³ãƒˆãƒ³å¤§ä¼š å‡ºå ´è€…èª¿æŸ»ã‚·ã‚¹ãƒ†ãƒ  èµ·å‹•å®Œäº†');
            console.log('ğŸ“Š 8ã‚«ãƒ†ã‚´ãƒªãƒ¼è©³ç´°é›†è¨ˆæ©Ÿèƒ½æ­è¼‰');
            console.log('ğŸ“± ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³å®Œå…¨å¯¾å¿œ');
            console.log('ğŸ” ç®¡ç†è€…æ©Ÿèƒ½: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ badminton2024');
        });
    </script>
</body>
</html>
